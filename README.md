# JOOQ-scala-mappingss

All the [JOOQ](http://www.jooq.org) power, in the [scala](http://www.scala-lang.org/) world.

### Why?
-----------

First of all, i love JOOQ. Is by far the better way to access any SQL DB from the JVM. It's the expressive, powerful and it's simply SQL.
In the other hand, i love scala. It's the most powerful language in the JVM: macros, for comprehension, pattern matching, lambda functions, etc etc (and like uncle ben said: *With great power comes great responsibility*).
So here i'll put all the scala power to make the life better to all the JOOQ lovers.

### Installation
------------

TODO: Publish maven central
TODO: Depends on jooq 3.6.1 or greater with scala codegen

### Functionalities
---------------

 1. [Record to entities mapping](#record-to-entity-mapping)
 2. Entity to record mapping
 3. Scala option support

More to come...

### Record to entity mapping

Given this mysql table:
```
CREATE TABLE `user` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `first_name` varchar(50) NOT NULL,
  `last_name` varchar(50) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
```
If i want to map this with my case class
```
case class User(id: java.lang.Long,
                firstName: String, 
                lastName: String) {
}
```
That is as simple as doing:
```
    val r = dsl.newRecord(Tables.USER)
    r setId 1l
    r setFirstName "name"
    r setLastName "last"

    val meta = org.scalajooq.JooqMeta.metaOf[tables.User, UserRecord, User]
    
    val user = meta toEntity r

```
Note: **tables.User** and **UserRecord** were autogenerated by the jooq scala codegen.
Note: To generate the dsl instance, see the JOOQ documentation

This is not magic, this is not reflections, this is a macro.
But what do i win? 
The answer is that now, all the problems you'll see now during compilation, not in rune-time. So, if for example, you have a bug in the user like this:

```
case class User(id: java.lang.Long,
                firsName: String, 
                lastName: String) {
}
```
You'll see a message like this:

```
Mappings error:
 org.scalajooq.User.firsName expects a db.test.public.tables.records.UserRecord.FIRS_NAME column, but doesn't exists
```
